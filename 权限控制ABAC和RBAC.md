# ACL

+ Access Control List

+ 一张表

  | 路由   | 用户    | 增   | 删   | 改   | 查   | ...  |
  | ------ | ------- | ---- | ---- | ---- | ---- | ---- |
  | /api/a | user-01 | 1    | 1    | 1    | 1    |      |
  | /api/a | user-02 | 0    | 0    | 0    | 1    |      |
  | /api/b | user-01 | 0    | 1    | 0    | 0    |      |
  | /api/b | user-02 | 0    | 0    | 1    | 1    |      |
  | ...    | ...     | ...  | ...  | ...  | ...  | ...  |

+ 每一项资源，都配有一个列表，这个列表记录的就是哪些用户可以对这项资源执行CRUD等操作。当试图访问这项资源时，会首先检查这个列表中是否有关于当前用户的访问权限，从而确定当前用户可否执行相应的操作
+ 上面这个表，如果用户非常多的话，就应该每一个路由对应一张表，新增一个用户，就要在这个用户有权限的表上新增一行。
+ 简单，难维护。如果两个用户对同一个路由有相同的权限，也要写两份记录；同理同一个用户对多个路由有相同的权限，仍然要写多份。

# RBAC

+ Role-Based Access Control 基于角色的访问控制

## 最基础的RBAC

+ RBAC0 用户和角色是多对多，角色和权限是多对多。一个用户拥有的权限，是他所有角色的集合。
+ 用户-角色-权限
+ **一个用户可以拥有多个角色，一个角色可以赋给不同的用户；一个角色可以拥有多个权限，一个权限也可以被多个角色拥有**

+ 所以最基础的RBAC模型最少需要五张表

## 升级RBAC

+ RBAC1。基于RBAC0，并引入了角色分层的概念，即一个角色分为多个等级，每个等级对应的权限是不一样的。把权限分给用户时，需要分到对应的角色等级。角色等级低时拥有的权限少，角色等级高的权限是所有角色等级低的权限的集合。

+ 如果一个部门上万人，那么我们就需要给这个部门上万人分别设置角色，而这上万其实是具有相同的权限的，如果直接采用基础的RBAC权限模型的话，那么面对这样的情况，无疑也是具有一个庞大的重复的工作量，并且也不利于后期用户变更的维护管理。

+ 用户与角色之间引入”用户组“。
+ 所谓”用户组“就是将具有相同角色的用户进行分类。
+ 进行批量的调度和权限的管理。

+ 一个用户可以属于多个用户组，一个用户组也可以包括多个用户，所以用户与用户组是多对多的关系。

+ RBAC2  基于RBAC1，对角色访问进行限制。如
  互斥角色限制。同一个用户分配到两个角色，且角色互斥时，那么系统应该提醒只能选择其中一个角色。比如员工拥有商务这个角色，可以创建结算单并提交给财务审核，这时，就不能赋予这个员工财务角色，否则他就自己提交结算自己审核结算单了。
  角色数量限制。一个用户拥有的角色数量是有限的；一个角色被分配的用户数量也是有限的。
  先决条件限制。用户想获得某个上级角色，必须先获得其下一级的角色。比如想获得产品总监的权限，那就需要从产品助理这一角色开始，再到产品经理角色，最后到产品总监角色。

+ RBAC3  基于RBAC0，对RBAC1和RBAC2进行了整合，是最全面的权限管理。 用户组
  当平台用户的基数增大，角色类型越来越多时，而且一部分人具有相同的属性，比如财务部的所有员工。

# ABAC

+ Attribute-Based Access Control 基于属性的权限验证
+ ABAC是一种为解决行业分布式应用可信关系访问控制模型，也表示词语的一种构成形式。
+ ABAC是一种为解决行业分布式应用可信关系访问控制模型，它利用相关实体(如主体、客体、环境)的属性作为授权的基础来研究如何进行访问控制。基于角色的访问控制（RBAC）通过引入角色中间元素，使得权限先经过角色进行聚合，然后再将权限分配给主体，通过这种方式可以简化授权，可将角色信息看成是一种属性，这样 RBAC 就成为了ABAC 的一种单属性特例。

> 在ABAC中，主体是对客体(资源)实施访问行为的实体，如用户、服务、通信实体等;

> 主体有定义其身份和特性的属性，包括主体的身份、角色、职位、能力、位置、行政关系以及CA
> 证书等，如用户这一主体，它可以以所处行业中用户属性特征为基础，将这些用户的某些属性进行标准化定义，包括某用户所属的部门、职务、主管业务等;

> 客体是被主体操作的实体，如文件、数据、服务、系统设备等，客体属性包括身份、位置(URL)
> 、大小、值，这些属性可从客体的“元数据”中获取，同样也可以由对其操的主体来继承。这就是说，客体属性与主体属性具有一定的相关性;
> 环境属性是与事务(或业务)处理关联的属性,它通常与身份无关,但适用于授权决策，如时间、日期、系统状态、安全级别等。

ABAC授权模型理论上能够实现非常灵活的权限控制，几乎能满足所有类型的需求。从使用场景来说比较适用于用户数量多并且授权比较复杂的场景。

例如

> 通过一个用户的单位、职位、IP地址来判断此客户是否可以在某个时间段访问服务器中的某个网页。

+ 设计和实现复杂

+ 安全
+ 效率也不高